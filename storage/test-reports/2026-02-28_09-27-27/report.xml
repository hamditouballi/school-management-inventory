<?xml version="1.0" encoding="UTF-8"?>
<testsuites>
  <testsuite name="C:\Users\hamditou\school-inventory-system\phpunit.xml" tests="18" assertions="44" errors="2" failures="2" skipped="0" time="42.125867">
    <testsuite name="Unit" tests="2" assertions="2" errors="0" failures="0" skipped="0" time="20.192787">
      <testsuite name="Tests\Unit\InvoiceTest" file="tests\Unit\InvoiceTest.php" tests="2" assertions="2" errors="0" failures="0" skipped="0" time="20.192787">
        <testcase name="invoice calculates total amount correctly from items" file="tests\Unit\InvoiceTest.php::invoice calculates total amount correctly from items" class="Tests\Unit\InvoiceTest" classname="Tests.Unit.InvoiceTest" assertions="1" time="20.073842"/>
        <testcase name="invoice has a type cast for date" file="tests\Unit\InvoiceTest.php::invoice has a type cast for date" class="Tests\Unit\InvoiceTest" classname="Tests.Unit.InvoiceTest" assertions="1" time="0.118946"/>
      </testsuite>
    </testsuite>
    <testsuite name="Feature" tests="16" assertions="42" errors="2" failures="2" skipped="0" time="21.933079">
      <testsuite name="Tests\Feature\AuthTest" file="tests\Feature\AuthTest.php" tests="5" assertions="11" errors="0" failures="0" skipped="0" time="16.700881">
        <testcase name="it allows a user to login with valid credentials" file="tests\Feature\AuthTest.php::it allows a user to login with valid credentials" class="Tests\Feature\AuthTest" classname="Tests.Feature.AuthTest" assertions="4" time="9.360216"/>
        <testcase name="it rejects login with invalid credentials" file="tests\Feature\AuthTest.php::it rejects login with invalid credentials" class="Tests\Feature\AuthTest" classname="Tests.Feature.AuthTest" assertions="2" time="0.648830"/>
        <testcase name="it prevents unauthorized users from accessing protected routes" file="tests\Feature\AuthTest.php::it prevents unauthorized users from accessing protected routes" class="Tests\Feature\AuthTest" classname="Tests.Feature.AuthTest" assertions="2" time="0.427574"/>
        <testcase name="it allows an authenticated user to access protected routes" file="tests\Feature\AuthTest.php::it allows an authenticated user to access protected routes" class="Tests\Feature\AuthTest" classname="Tests.Feature.AuthTest" assertions="1" time="5.955452"/>
        <testcase name="it ensures role-based isolation works correctly" file="tests\Feature\AuthTest.php::it ensures role-based isolation works correctly" class="Tests\Feature\AuthTest" classname="Tests.Feature.AuthTest" assertions="2" time="0.308810"/>
      </testsuite>
      <testsuite name="Tests\Feature\InvoiceCrudTest" file="tests\Feature\InvoiceCrudTest.php" tests="7" assertions="19" errors="0" failures="0" skipped="0" time="2.397121">
        <testcase name="it can list all invoices" file="tests\Feature\InvoiceCrudTest.php::it can list all invoices" class="Tests\Feature\InvoiceCrudTest" classname="Tests.Feature.InvoiceCrudTest" assertions="2" time="1.090766"/>
        <testcase name="it can create a new invoice with items" file="tests\Feature\InvoiceCrudTest.php::it can create a new invoice with items" class="Tests\Feature\InvoiceCrudTest" classname="Tests.Feature.InvoiceCrudTest" assertions="4" time="0.739571"/>
        <testcase name="it returns validation errors when creating an invoice with invalid data" file="tests\Feature\InvoiceCrudTest.php::it returns validation errors when creating an invoice with invalid data" class="Tests\Feature\InvoiceCrudTest" classname="Tests.Feature.InvoiceCrudTest" assertions="5" time="0.218674"/>
        <testcase name="it can show a specific invoice" file="tests\Feature\InvoiceCrudTest.php::it can show a specific invoice" class="Tests\Feature\InvoiceCrudTest" classname="Tests.Feature.InvoiceCrudTest" assertions="2" time="0.028808"/>
        <testcase name="it returns 404 when showing a non-existent invoice" file="tests\Feature\InvoiceCrudTest.php::it returns 404 when showing a non-existent invoice" class="Tests\Feature\InvoiceCrudTest" classname="Tests.Feature.InvoiceCrudTest" assertions="1" time="0.215220"/>
        <testcase name="it can update an existing invoice" file="tests\Feature\InvoiceCrudTest.php::it can update an existing invoice" class="Tests\Feature\InvoiceCrudTest" classname="Tests.Feature.InvoiceCrudTest" assertions="3" time="0.064834"/>
        <testcase name="it can delete an invoice" file="tests\Feature\InvoiceCrudTest.php::it can delete an invoice" class="Tests\Feature\InvoiceCrudTest" classname="Tests.Feature.InvoiceCrudTest" assertions="2" time="0.039248"/>
      </testsuite>
      <testsuite name="Tests\Feature\Scenarios\FinanceManagerScenarioTest" file="tests\Feature\Scenarios\FinanceManagerScenarioTest.php" tests="1" assertions="1" errors="1" failures="0" skipped="0" time="2.282298">
        <testcase name="finance manager full workflow scenario" file="tests\Feature\Scenarios\FinanceManagerScenarioTest.php::finance manager full workflow scenario" class="Tests\Feature\Scenarios\FinanceManagerScenarioTest" classname="Tests.Feature.Scenarios.FinanceManagerScenarioTest" assertions="1" time="2.282298">
          <error type="Illuminate\Database\QueryException">finance manager full workflow scenarioIlluminate\Database\QueryException: SQLSTATE[23000]: Integrity constraint violation: 19 CHECK constraint failed: status (Connection: sqlite, SQL: insert into "purchase_orders" ("date", "id_responsible_stock", "status", "supplier", "total_amount", "updated_at", "created_at") values (2026-02-28 09:28:41, 2, final_approved, Stationery Hub, 500, 2026-02-28 09:28:41, 2026-02-28 09:28:41))&#13;
at vendor\laravel\framework\src\Illuminate\Database\Connection.php:571
at vendor\laravel\framework\src\Illuminate\Database\Connection.php:812
at vendor\laravel\framework\src\Illuminate\Database\Connection.php:779
at vendor\laravel\framework\src\Illuminate\Database\Connection.php:560
at vendor\laravel\framework\src\Illuminate\Database\Connection.php:524
at vendor\laravel\framework\src\Illuminate\Database\Query\Processors\Processor.php:32
at vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3766
at vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:2120
at vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1359
at vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1324
at vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1163
at vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:352
at vendor\laravel\framework\src\Illuminate\Collections\Traits\EnumeratesValues.php:261
at vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:347
at vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:303
at vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:297
at tests\Feature\Scenarios\FinanceManagerScenarioTest.php:33
Caused by
PDOException: SQLSTATE[23000]: Integrity constraint violation: 19 CHECK constraint failed: status

at vendor\laravel\framework\src\Illuminate\Database\Connection.php:571
at vendor\laravel\framework\src\Illuminate\Database\Connection.php:812
at vendor\laravel\framework\src\Illuminate\Database\Connection.php:779
at vendor\laravel\framework\src\Illuminate\Database\Connection.php:560
at vendor\laravel\framework\src\Illuminate\Database\Connection.php:524
at vendor\laravel\framework\src\Illuminate\Database\Query\Processors\Processor.php:32
at vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3766
at vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:2120
at vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1359
at vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1324
at vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1163
at vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:352
at vendor\laravel\framework\src\Illuminate\Collections\Traits\EnumeratesValues.php:261
at vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:347
at vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:303
at vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:297
at tests\Feature\Scenarios\FinanceManagerScenarioTest.php:33</error>
        </testcase>
      </testsuite>
      <testsuite name="Tests\Feature\Scenarios\HRManagerScenarioTest" file="tests\Feature\Scenarios\HRManagerScenarioTest.php" tests="1" assertions="4" errors="1" failures="0" skipped="0" time="0.037268">
        <testcase name="hr manager full workflow scenario" file="tests\Feature\Scenarios\HRManagerScenarioTest.php::hr manager full workflow scenario" class="Tests\Feature\Scenarios\HRManagerScenarioTest" classname="Tests.Feature.Scenarios.HRManagerScenarioTest" assertions="4" time="0.037268">
          <error type="Illuminate\Database\QueryException">hr manager full workflow scenarioIlluminate\Database\QueryException: SQLSTATE[23000]: Integrity constraint violation: 19 NOT NULL constraint failed: purchase_orders.supplier (Connection: sqlite, SQL: insert into "purchase_orders" ("date", "id_responsible_stock", "status", "supplier", "total_amount", "updated_at", "created_at") values (2026-02-28 09:28:42, 2, pending_initial_approval, ?, 0, 2026-02-28 09:28:42, 2026-02-28 09:28:42))&#13;
at vendor\laravel\framework\src\Illuminate\Database\Connection.php:571
at vendor\laravel\framework\src\Illuminate\Database\Connection.php:812
at vendor\laravel\framework\src\Illuminate\Database\Connection.php:779
at vendor\laravel\framework\src\Illuminate\Database\Connection.php:560
at vendor\laravel\framework\src\Illuminate\Database\Connection.php:524
at vendor\laravel\framework\src\Illuminate\Database\Query\Processors\Processor.php:32
at vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3766
at vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:2120
at vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1359
at vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1324
at vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1163
at vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:352
at vendor\laravel\framework\src\Illuminate\Collections\Traits\EnumeratesValues.php:261
at vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:347
at vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:303
at vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:297
at tests\Feature\Scenarios\HRManagerScenarioTest.php:41
Caused by
PDOException: SQLSTATE[23000]: Integrity constraint violation: 19 NOT NULL constraint failed: purchase_orders.supplier

at vendor\laravel\framework\src\Illuminate\Database\Connection.php:571
at vendor\laravel\framework\src\Illuminate\Database\Connection.php:812
at vendor\laravel\framework\src\Illuminate\Database\Connection.php:779
at vendor\laravel\framework\src\Illuminate\Database\Connection.php:560
at vendor\laravel\framework\src\Illuminate\Database\Connection.php:524
at vendor\laravel\framework\src\Illuminate\Database\Query\Processors\Processor.php:32
at vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3766
at vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:2120
at vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1359
at vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1324
at vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1163
at vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:352
at vendor\laravel\framework\src\Illuminate\Collections\Traits\EnumeratesValues.php:261
at vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:347
at vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:303
at vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:297
at tests\Feature\Scenarios\HRManagerScenarioTest.php:41</error>
        </testcase>
      </testsuite>
      <testsuite name="Tests\Feature\Scenarios\StockManagerScenarioTest" file="tests\Feature\Scenarios\StockManagerScenarioTest.php" tests="1" assertions="3" errors="0" failures="1" skipped="0" time="0.456930">
        <testcase name="stock manager full workflow scenario" file="tests\Feature\Scenarios\StockManagerScenarioTest.php::stock manager full workflow scenario" class="Tests\Feature\Scenarios\StockManagerScenarioTest" classname="Tests.Feature.Scenarios.StockManagerScenarioTest" assertions="3" time="0.456930">
          <failure type="PHPUnit\Framework\ExpectationFailedException">stock manager full workflow scenarioExpected response status code [201] but received 500.
Failed asserting that 500 is identical to 201.&#13;
at vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
at vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
at tests\Feature\Scenarios\StockManagerScenarioTest.php:48</failure>
        </testcase>
      </testsuite>
      <testsuite name="Tests\Feature\Scenarios\TeacherScenarioTest" file="tests\Feature\Scenarios\TeacherScenarioTest.php" tests="1" assertions="4" errors="0" failures="1" skipped="0" time="0.058582">
        <testcase name="teacher full workflow scenario" file="tests\Feature\Scenarios\TeacherScenarioTest.php::teacher full workflow scenario" class="Tests\Feature\Scenarios\TeacherScenarioTest" classname="Tests.Feature.Scenarios.TeacherScenarioTest" assertions="4" time="0.058582">
          <failure type="PHPUnit\Framework\ExpectationFailedException">teacher full workflow scenarioExpected response status code [403] but received 200.
Failed asserting that 200 is identical to 403.&#13;
at vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
at vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
at tests\Feature\Scenarios\TeacherScenarioTest.php:38</failure>
        </testcase>
      </testsuite>
    </testsuite>
  </testsuite>
</testsuites>
